<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BME | EEG Analysis - Convolution and Dot Product | Aursus</title><meta name="keywords" content="Biomedical Engineering"><meta name="author" content="Aursus"><meta name="copyright" content="Aursus"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Dot Product Mathematical Definition Assuming two input vectors, $x &#x3D; [x_1, x_2, …, x_n]$ and $y &#x3D; [y_1, y_2, …, y_n]$, the dot product is calculated as: $$ x \cdot y &#x3D; \sum_{i&#x3D;1}^n x_i y_i &#x3D; x_1y_1+x_">
<meta property="og:type" content="article">
<meta property="og:title" content="BME | EEG Analysis - Convolution and Dot Product">
<meta property="og:url" content="https://aursus.github.io/en/eeg-convolution.html">
<meta property="og:site_name" content="Aursus">
<meta property="og:description" content="Dot Product Mathematical Definition Assuming two input vectors, $x &#x3D; [x_1, x_2, …, x_n]$ and $y &#x3D; [y_1, y_2, …, y_n]$, the dot product is calculated as: $$ x \cdot y &#x3D; \sum_{i&#x3D;1}^n x_i y_i &#x3D; x_1y_1+x_">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2023-03-13T21:22:49.000Z">
<meta property="article:modified_time" content="2023-12-12T21:45:47.955Z">
<meta property="article:author" content="Aursus">
<meta property="article:tag" content="Biomedical Engineering">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/en/img/icon.png"><link rel="canonical" href="https://aursus.github.io/en/eeg-convolution"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/en/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/en/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"中"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BME | EEG Analysis - Convolution and Dot Product',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-12 16:45:47'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/en/img/icon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">35</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">4</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-language"></i><span> Language</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://aursus.github.io/"><i class="fa-fw fas fa-c"></i><span> 中文</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/en/">Aursus</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-language"></i><span> Language</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://aursus.github.io/"><i class="fa-fw fas fa-c"></i><span> 中文</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BME | EEG Analysis - Convolution and Dot Product</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-03-13T21:22:49.000Z" title="Created 2023-03-13 17:22:49">2023-03-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-12-12T21:45:47.955Z" title="Updated 2023-12-12 16:45:47">2023-12-12</time></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Dot-Product">Dot Product</h2>
<h3 id="Mathematical-Definition">Mathematical Definition</h3>
<p>Assuming two input vectors, $x = [x_1, x_2, …, x_n]$ and $y = [y_1, y_2, …, y_n]$, the dot product is calculated as:</p>
<p>$$<br>
x \cdot y = \sum_{i=1}^n x_i y_i = x_1y_1+x_2y_2+…+x_ny_n<br>
$$</p>
<h3 id="Code">Code</h3>
<p>MATLAB Code:</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">z = <span class="built_in">dot</span>(x, y)</span><br><span class="line">z = x * y&#x27;</span><br></pre></td></tr></table></figure>
<p>Python Code</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">z = np.dot(x, y)</span><br></pre></td></tr></table></figure>
<h2 id="Convolution">Convolution</h2>
<h3 id="Mathematical-Definitions">Mathematical Definitions</h3>
<p>Discrete Convolution Definition:</p>
<p>Assuming two vectors, $x = [x_1, x_2, …, x_n]$ and $h = [h_1, h_2, …, h_n]$, the convolution result is calculated as:</p>
<p>$$<br>
(x * h)[n] = x[n] * h[n] = \sum_{i=-\infty}^{+\infty} x(i) h(n-i) = \sum_{i=-\infty}^{+\infty} x(n-i) h(i)<br>
$$</p>
<p>Continuous Convolution Definition:</p>
<p>Assuming two continuous functions $x(t)$ and $h(t)$, the convolution result is:</p>
<p>$$<br>
(x * h)(t) = x(t) * h(t) = \int_{-\infty}^{+\infty} x(\tau) h(t-\tau)d\tau = \int_{-\infty}^{+\infty} x(t-\tau) h(\tau)d\tau<br>
$$</p>
<h3 id="Explanation-and-Understanding">Explanation and Understanding</h3>
<p>Convolution is commonly applied to signals where ‘x’ represents the signal and ‘h’ is the convolution kernel, usually shorter than the signal.</p>
<p>Discrete Convolution: If both the <strong>signal</strong> ‘x’ and the <strong>convolution kernel</strong> ‘h’ are discrete, convolution can be understood as ‘h’ sliding along ‘x’, taking a set of data points equal to ‘h’ and performing point-wise multiplication, summing up the results as the first convolution output. The <strong>convolution kernel ‘h’</strong> then slides to the right by one unit, repeating the process to obtain subsequent convolution results until the <strong>signal ‘x’</strong> is completely traversed.</p>
<p>Continuous Convolution: If both the <strong>signal</strong> ‘x’ and the <strong>convolution kernel</strong> ‘h’ are continuous, convolution can be visualized as the overlap between ‘x’ and ‘h’, with the area of overlap representing the first convolution result. The <strong>convolution kernel ‘h’</strong> then slides along the <strong>signal ‘x’</strong>, repeating the process to obtain subsequent convolution results until the <strong>signal ‘x’</strong> is entirely covered.</p>
<p>In theory, convolution occurs from negative infinity to positive infinity, but in practice, only non-zero sections of the signal ‘x’ are considered. The length of the resulting convolution might require manual selection, although MATLAB and Python offer options for the convolution result’s length. Padding the signal’s ends with zeros ensures full coverage by the kernel. Post-convolution scaling may alter the amplitude, and to compare with the original signal amplitude, dividing the convolution result by the kernel’s length suffices. Odd-length kernels are typically recommended.</p>
<h3 id="Code-2">Code</h3>
<p>Matlab Code</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = conv(u, h) <span class="comment">% Equivalent to conv(h, u)</span></span><br><span class="line">y = conv(u, h, <span class="string">&#x27;same&#x27;</span>) <span class="comment">% Options: full, same, valid - see official documentation for usage</span></span><br></pre></td></tr></table></figure>
<p>Python Code</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = np.convolve(u, h) <span class="comment"># Equivalent to conv(h, u)</span></span><br><span class="line">y = np.convolve(u, h, <span class="string">&#x27;same&#x27;</span>) <span class="comment"># Options: full, same, valid - see official documentation for usage</span></span><br></pre></td></tr></table></figure>
<p>! Exercise</p>
<p>Calculate the moving average of a signal using a kernel of length 11.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = cumsum(<span class="built_in">randn</span>(<span class="number">1</span>,<span class="number">1000</span>))</span><br><span class="line">h = <span class="built_in">ones</span>(<span class="number">1</span>,<span class="number">11</span>)</span><br><span class="line">MA = conv(x, h, <span class="string">&#x27;same&#x27;</span>)/<span class="number">11</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.cumsum(np.random.randn(<span class="number">1</span>, <span class="number">1000</span>))</span><br><span class="line">h = np.ones(<span class="number">11</span>)</span><br><span class="line">MA = np.convolve(x, h, mode=<span class="string">&#x27;same&#x27;</span>) / <span class="number">11</span></span><br></pre></td></tr></table></figure>
</article><div class="tag_share"><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/en/anatomy-respiratory.html"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/en/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">BME | Anatomy - Respiratory System</div></div></a></div><div class="next-post pull-right"><a href="/en/eeg-intro.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/en/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">BME | EEG Analysis - Introduction</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/en/img/icon.png" onerror="this.onerror=null;this.src='/en/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Aursus</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">35</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">4</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Aursus" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:aursus.blog@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.linkedin.com/in/yuji-han/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Dot-Product"><span class="toc-number">1.</span> <span class="toc-text">Dot Product</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mathematical-Definition"><span class="toc-number">1.1.</span> <span class="toc-text">Mathematical Definition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code"><span class="toc-number">1.2.</span> <span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Convolution"><span class="toc-number">2.</span> <span class="toc-text">Convolution</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mathematical-Definitions"><span class="toc-number">2.1.</span> <span class="toc-text">Mathematical Definitions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Explanation-and-Understanding"><span class="toc-number">2.2.</span> <span class="toc-text">Explanation and Understanding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-2"><span class="toc-number">2.3.</span> <span class="toc-text">Code</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Aursus</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Switch Between English And Simplified Chinese">EN</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/en/js/utils.js"></script><script src="/en/js/main.js"></script><script src="/en/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script data-pjax src="/en/self/btf.js"></script><script data-pjax src="/en/self/ch_en.js"></script></div></body></html>
<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BME | EEG Analysis - Wavelet Transform | Aursus</title><meta name="keywords" content="Major"><meta name="author" content="Aursus"><meta name="copyright" content="Aursus"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Basic Concept: Wavelet Transform The wavelet transform uses a group of short kernels (wavelets) of different frequencies convolved with the original signal. Thus, the signal only needs to be stable ov">
<meta property="og:type" content="article">
<meta property="og:title" content="BME | EEG Analysis - Wavelet Transform">
<meta property="og:url" content="https://aursus.github.io/en/eeg-wavelet.html">
<meta property="og:site_name" content="Aursus">
<meta property="og:description" content="Basic Concept: Wavelet Transform The wavelet transform uses a group of short kernels (wavelets) of different frequencies convolved with the original signal. Thus, the signal only needs to be stable ov">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2023-12-04T06:35:05.000Z">
<meta property="article:modified_time" content="2024-01-06T04:24:33.738Z">
<meta property="article:author" content="Aursus">
<meta property="article:tag" content="Major">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/en/img/icon.png"><link rel="canonical" href="https://aursus.github.io/en/eeg-wavelet"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/en/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/en/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"中"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BME | EEG Analysis - Wavelet Transform',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-05 23:24:33'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/en/img/icon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">45</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-language"></i><span> Language</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://aursus.github.io/"><i class="fa-fw fas fa-c"></i><span> 中文</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/en/">Aursus</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-language"></i><span> Language</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://aursus.github.io/"><i class="fa-fw fas fa-c"></i><span> 中文</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BME | EEG Analysis - Wavelet Transform</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-12-04T06:35:05.000Z" title="Created 2023-12-04 01:35:05">2023-12-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-01-06T04:24:33.738Z" title="Updated 2024-01-05 23:24:33">2024-01-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Biomedical-Engineering/">Biomedical Engineering</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Biomedical-Engineering/EEG-Analysis/">EEG Analysis</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="basic-concept-wavelet-transform">Basic Concept: Wavelet Transform</h2>
<p>The wavelet transform uses a group of short kernels (wavelets) of different frequencies convolved with the original signal. Thus, the signal only needs to be stable over the length of the wavelet (stationary).</p>
<p>Similar to Fourier transform, when the signal frequency matches the wavelet frequency, the dot product yields larger amplitude results.</p>
<p>Wavelet convolution can be utilized as a band-pass filter.</p>
<h3 id="convolution-kernels">Convolution Kernels</h3>
<h4 id="types-of-wavelets">Types of Wavelets</h4>
<p>There are various types of convolution kernels (wavelets) in wavelet transforms. Different types affect temporal precision. The most commonly used type is the Gaussian kernel (Morlet Wavelet).</p>
<p>Types of Wavelets: <a target="_blank" rel="noopener" href="https://www.mathworks.com/help/wavelet/gs/introduction-to-the-wavelet-families.html">MathWorks - Introduction to the Wavelet Families</a></p>
<h4 id="wavelet-families">Wavelet Families</h4>
<p>Definition: A set of wavelets of the same type but different frequencies is referred to as a family.</p>
<p><img src="eeg-wavelet/image_bqyp2J76Pe.png" alt="Morlet Wavelet Family" title="Morlet Wavelet Family"></p>
<p>The Morlet wavelet appears as a Gaussian envelope in the time domain with a sinusoidal function inside. In the frequency domain, it resembles a Gaussian function with its peak at the wavelet’s frequency, f.</p>
<p><img src="eeg-wavelet/image_fqCPg2mxkX.png" alt=""></p>
<h3 id="real-valued-morlet-wavelet">Real-valued Morlet Wavelet</h3>
<p>Mathematical formula:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>sin</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><mi>f</mi><mi>t</mi><mo>∗</mo><mi>a</mi><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>t</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">a\sin 2\pi ft * a e^{-t^2/(2s^2)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0369199999999998em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>Q: How is the Morlet wavelet constructed?</p>
<p>Construct a sine wave and multiply it by a Gaussian window to obtain the Morlet wavelet. It’s essential to consider the sampling frequency and the number of points in both the Gaussian window and the sine wave.</p>
<p>Q: What is the specific formula?</p>
<p>Sine wave formula: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>sin</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><mi>f</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">a\sin 2\pi ft</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">t</span></span></span></span></p>
<p>Gaussian formula: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>t</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">a e^{-t^2/(2s^2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9869199999999998em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999998em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mfrac><mi>n</mi><mrow><mn>2</mn><mi>π</mi><mi>f</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">s=\frac{n}{2\pi f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1764999999999999em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>Wavelet formula: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>sin</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><mi>f</mi><mi>t</mi><mo>∗</mo><mi>a</mi><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>t</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">a\sin 2\pi ft * a e^{-t^2/(2s^2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9869199999999998em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999998em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>n represents wavelet cycles, balancing temporal precision and frequency precision, and f denotes the wavelet frequency.</p>
<p>Q: How should one choose frequency and cycles?</p>
<p>Minimum frequency: The theoretical lower limit is 1 times the epoch-related frequency, but typically, 4 times the epoch-related frequency is chosen. For instance, for an epoch of 1 second, at least 4Hz is selected as the wavelet frequency.</p>
<p>Maximum frequency: The theoretical upper limit is the Nyquist frequency, but it’s common to ensure four sample points in each cycle. For example, with a 500Hz sampling frequency, a maximum of 125Hz is chosen as the wavelet frequency.</p>
<p>Number of wavelet families: Generally, 20-30 different frequencies are selected. For EEG cognitive tasks, 4-60Hz is usually chosen.</p>
<p><img src="eeg-wavelet/image__VdjWPn1wp.png" alt=""></p>
<p><img src="eeg-wavelet/image_ladqk34A5y.png" alt=""></p>
<p>Q: Are there any issues with real-valued wavelets?</p>
<p>Similar to Fourier transform, pure real-valued convolution kernels require the original signal and the kernel to have the same phase. Hence, complex-valued wavelets are introduced.</p>
<h4 id="code">Code</h4>
<p>Exercise</p>
<p>Suppose I have a signal that is 60 seconds long with a sampling frequency of 100Hz, and I want to perform wavelet convolution. How should I write the code?</p>
<p>Maltab</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% wavelet parameters</span></span><br><span class="line">fs = <span class="number">100</span>;</span><br><span class="line">wTime = <span class="number">-1</span>:(<span class="number">1</span>/fs):<span class="number">0.99</span>;</span><br><span class="line">wFreq = <span class="number">1</span>:<span class="number">2</span>:<span class="number">25</span>;</span><br><span class="line">n = <span class="number">4</span>;</span><br><span class="line">wLength = <span class="built_in">length</span>(wTime);</span><br><span class="line"></span><br><span class="line"><span class="comment">% creat test data</span></span><br><span class="line">dataTime = <span class="number">-10</span>:(<span class="number">1</span>/fs):<span class="number">10</span>;</span><br><span class="line">data = <span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>*<span class="number">4</span>*dataTime);</span><br><span class="line">data = [<span class="built_in">zeros</span>(<span class="number">1</span>,wLength/<span class="number">2</span>) data <span class="built_in">zeros</span>(<span class="number">1</span>,wLength/<span class="number">2</span>)];</span><br><span class="line"></span><br><span class="line"><span class="comment">% initialize matrix</span></span><br><span class="line">wavelet_conv = <span class="built_in">zeros</span>(<span class="built_in">length</span>(wFreq),<span class="built_in">length</span>(dataTime));</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(wFreq)</span><br><span class="line">  f = wFreq(<span class="built_in">i</span>);</span><br><span class="line">  s = n/(<span class="number">2</span>*<span class="built_in">pi</span>*f);</span><br><span class="line">  wavelet = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*f*wTime).*<span class="built_in">exp</span>(-(wTime.^<span class="number">2</span>)/(<span class="number">2</span>*s^<span class="number">2</span>));</span><br><span class="line">  kernel = <span class="built_in">fliplr</span>(wavelet);</span><br><span class="line">  conv_result = conv(data,kernel,<span class="string">&#x27;same&#x27;</span>)/sum(kernel);</span><br><span class="line">  wavelet_conv(<span class="built_in">i</span>,:) = conv_result(wLength/<span class="number">2</span>:wLength/<span class="number">2</span>+<span class="built_in">length</span>(dataTime)<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% plot</span></span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">imagesc(dataTime, wFreq, wavelet_conv)</span><br><span class="line">colormap(<span class="string">&quot;jet&quot;</span>)</span><br><span class="line">colorbar</span><br><span class="line">xlabel(<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;frequency&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="eeg-wavelet/image_sTJCHLk5hZ.png" alt="Note that there is a side effect in the result, and there is a certain variance at 4Hz" title="Note that there is a side effect in the result, and there is a certain variance at 4Hz"></p>
<p>Python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># wavelet parameters</span></span><br><span class="line">fs = <span class="number">100</span></span><br><span class="line">wTime = np.arange(-<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>/fs)</span><br><span class="line">wFreq = np.arange(<span class="number">1</span>, <span class="number">26</span>, <span class="number">2</span>)</span><br><span class="line">n = <span class="number">4</span></span><br><span class="line">wLength = <span class="built_in">len</span>(wTime)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create test data</span></span><br><span class="line">dataTime = np.arange(-<span class="number">10</span>, <span class="number">10</span>, <span class="number">1</span>/fs)</span><br><span class="line">data = np.sin(<span class="number">2</span>*np.pi*<span class="number">4</span>*dataTime)</span><br><span class="line">data = np.concatenate((np.zeros(wLength//<span class="number">2</span>), data, np.zeros(wLength//<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize matrix</span></span><br><span class="line">wavelet_conv = np.zeros((<span class="built_in">len</span>(wFreq), <span class="built_in">len</span>(dataTime)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(wFreq)):</span><br><span class="line">    f = wFreq[i]</span><br><span class="line">    s = n/(<span class="number">2</span>*np.pi*f)</span><br><span class="line">    wavelet = np.cos(<span class="number">2</span>*np.pi*f*wTime) * np.exp(-(wTime**<span class="number">2</span>)/(<span class="number">2</span>*s**<span class="number">2</span>))</span><br><span class="line">    kernel = np.flip(wavelet)</span><br><span class="line">    conv_result = np.convolve(data, kernel, <span class="string">&#x27;same&#x27;</span>)/np.<span class="built_in">sum</span>(kernel)</span><br><span class="line">    wavelet_conv[i, :] = conv_result[wLength//<span class="number">2</span>:wLength//<span class="number">2</span>+<span class="built_in">len</span>(dataTime)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">plt.figure()</span><br><span class="line">plt.imshow(wavelet_conv, aspect=<span class="string">&#x27;auto&#x27;</span>, extent=[<span class="built_in">min</span>(dataTime), <span class="built_in">max</span>(dataTime),  <span class="built_in">max</span>(wFreq), <span class="built_in">min</span>(wFreq) ], cmap=<span class="string">&#x27;jet&#x27;</span>)</span><br><span class="line"><span class="comment"># 注意这里max(wFreq)和min(wFreq)需要对换</span></span><br><span class="line">plt.colorbar()</span><br><span class="line">plt.xlabel(<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;frequency&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="eeg-wavelet/image_tzlh1Av08p.png" alt=""></p>
<h3 id="complex-valued-morlet-wavelet">Complex-valued Morlet Wavelet</h3>
<p>Mathematical formula:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>t</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mn>2</mn><msup><mi>s</mi><mn>2</mn></msup></mrow></msup><msup><mi>e</mi><mrow><mi>i</mi><mn>2</mn><mi>π</mi><mi>f</mi><mi>t</mi></mrow></msup><mspace width="1em"/><mtext>where</mtext><mi>A</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mo stretchy="false">(</mo><mi>s</mi><msqrt><mi>π</mi></msqrt><msup><mo stretchy="false">)</mo><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">Ae^{-t^2/2s^2}e^{i2\pi ft} \quad \text{where} A=\frac{1}{(s\sqrt{\pi})^{1/2}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0369199999999998em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">where</span></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.2754399999999997em;vertical-align:-0.954em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>The left part is Gaussian, and the right part is a complex sinusoid.</p>
<p>Q: What is a complex wavelet?</p>
<p>The real and imaginary parts of the complex wavelet and their 3D representation are depicted below:</p>
<p><img src="eeg-wavelet/image_OxCXPzC90g.png" alt="Real and imaginary parts of a complex wavelet"></p>
<p>Q: How to interpret the results of convolution?</p>
<p>The result of complex wavelet convolution is a vector in the complex plane.</p>
<p><img src="eeg-wavelet/image_f9r2Kcb4UL.png" alt="Convolution result in the complex plane"></p>
<p>The <strong>magnitude</strong> of the complex vector represents how the signal’s power at the wavelet frequency changes over time (unaffected by phase).</p>
<p>The <strong>phase</strong> of the complex vector represents the phase relationship between the wavelet and the signal.</p>
<p>The <strong>real part</strong> of the complex vector is the result of the signal passing through a band-pass filter.</p>
<p><img src="eeg-wavelet/image_5W7t0Z5OIV.png" alt="Real part, magnitude, and phase angle of the convolution result" title="Real part, magnitude, and phase angle of the convolution result"></p>
<p><img src="eeg-wavelet/image_XJIA6Au0xJ.png" alt="Analyzing phase from the image" title="Analyzing phase from the image"></p>
<p>Q: How to choose parameters for the wavelet?</p>
<p>Number of cycles <code>n</code>: n determines the width of the wavelet. A larger n provides better frequency precision but poorer temporal precision.</p>
<p>Generally, for studying transient changes, 3-4 cycles are preferred, while for studying frequency changes, 7-10 cycles are chosen. Different cycle numbers can also be used at different frequencies.</p>
<p><img src="eeg-wavelet/image_nK8RniJZQp.png" alt="Choosing the number of cycles"></p>
<p>Y-axis scaling:</p>
<p>Using an exponential logarithmic axis highlights the low-frequency range.</p>
<p>Using a linear axis highlights the high-frequency range.</p>
<p><img src="eeg-wavelet/image_nCW-qaYpu8.png" alt="Y-axis scaling"></p>
<p>Number of frequencies:</p>
<p>More frequencies yield higher resolution results. However, after a certain point, adding more frequencies may not provide significant benefits.</p>
<p><img src="eeg-wavelet/image_lAWgwUnVtj.png" alt="Number of frequencies"></p>
<p><img src="eeg-wavelet/image_sgOzyW1KQT.png" alt="Resulting resolution with different frequencies"></p>
<p>Length of wavelet: There is no maximum limit on the wavelet length. Its ends must approach zero, with its center at t=0. The sampling rate should match the signal’s.</p>
<h4 id="code">Code</h4>
<p>! practise</p>
<p>Suppose I have a 60s long signal with a sampling frequency of 100Hz and I want to perform complex-based wavelet convolution. How should the code be written?</p>
<p>Maltab</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% wavelet parameters</span></span><br><span class="line">fs = <span class="number">100</span>;</span><br><span class="line">wTime = <span class="number">-1</span>:(<span class="number">1</span>/fs):<span class="number">0.99</span>;</span><br><span class="line">wFreq = <span class="number">1</span>:<span class="number">2</span>:<span class="number">25</span>;</span><br><span class="line">n = <span class="number">4</span>;</span><br><span class="line">wLength = <span class="built_in">length</span>(wTime);</span><br><span class="line"></span><br><span class="line"><span class="comment">% creat test data</span></span><br><span class="line">dataTime = <span class="number">-10</span>:(<span class="number">1</span>/fs):<span class="number">10</span>;</span><br><span class="line">data = <span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>*<span class="number">4</span>*dataTime);</span><br><span class="line">data = [<span class="built_in">zeros</span>(<span class="number">1</span>,wLength/<span class="number">2</span>) data <span class="built_in">zeros</span>(<span class="number">1</span>,wLength/<span class="number">2</span>)];</span><br><span class="line"></span><br><span class="line"><span class="comment">% initialize matrix</span></span><br><span class="line">wavelet_conv = <span class="built_in">zeros</span>(<span class="built_in">length</span>(wFreq),<span class="built_in">length</span>(dataTime));</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(wFreq)</span><br><span class="line">  f = wFreq(<span class="built_in">i</span>);</span><br><span class="line">  s = n/(<span class="number">2</span>*<span class="built_in">pi</span>*f);</span><br><span class="line">  A = <span class="number">1</span>/((s*<span class="built_in">sqrt</span>(<span class="built_in">pi</span>))^<span class="number">0.5</span>);</span><br><span class="line">  wavelet = A.*<span class="built_in">exp</span>(-(wTime.^<span class="number">2</span>)/(<span class="number">2</span>*s^<span class="number">2</span>)).*<span class="built_in">exp</span>(<span class="number">1</span><span class="built_in">i</span>*<span class="number">2</span>*<span class="built_in">pi</span>*f.*wTime);</span><br><span class="line"><span class="comment">%   wavelet = exp(2*1i*pi*frex(fi).*time) .* exp(-time.^2./(2*(numcycles(fi)/(2*pi*frex(fi)))^2));</span></span><br><span class="line">  kernel = <span class="built_in">fliplr</span>(wavelet);</span><br><span class="line">  conv_result = conv(data,kernel,<span class="string">&#x27;same&#x27;</span>);</span><br><span class="line">  wavelet_conv(<span class="built_in">i</span>,:) = conv_result(wLength/<span class="number">2</span>:wLength/<span class="number">2</span>+<span class="built_in">length</span>(dataTime)<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% plot</span></span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">imagesc(dataTime, wFreq, <span class="built_in">abs</span>(wavelet_conv))</span><br><span class="line">colormap(<span class="string">&quot;jet&quot;</span>)</span><br><span class="line">colorbar</span><br><span class="line">xlabel(<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;frequency&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># wavelet parameters</span></span><br><span class="line">fs = <span class="number">100</span></span><br><span class="line">wTime = np.arange(-<span class="number">1</span>, <span class="number">1.01</span>, <span class="number">1</span>/fs)</span><br><span class="line">wFreq = np.arange(<span class="number">1</span>, <span class="number">26</span>, <span class="number">2</span>)</span><br><span class="line">n = <span class="number">4</span></span><br><span class="line">wLength = <span class="built_in">len</span>(wTime)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create test data</span></span><br><span class="line">dataTime = np.arange(-<span class="number">10</span>, <span class="number">10.01</span>, <span class="number">1</span>/fs)</span><br><span class="line">data = np.sin(<span class="number">2</span>*np.pi*<span class="number">4</span>*dataTime)</span><br><span class="line">data = np.concatenate((np.zeros(wLength//<span class="number">2</span>), data, np.zeros(wLength//<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize matrix</span></span><br><span class="line">wavelet_conv = np.zeros((<span class="built_in">len</span>(wFreq), <span class="built_in">len</span>(dataTime)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(wFreq)):</span><br><span class="line">    f = wFreq[i]</span><br><span class="line">    s = n/(<span class="number">2</span>*np.pi*f)</span><br><span class="line">    A = <span class="number">1</span>/np.sqrt(s*np.sqrt(np.pi))</span><br><span class="line">    wavelet = A * np.exp(-(wTime**<span class="number">2</span>)/(<span class="number">2</span>*s**<span class="number">2</span>)) * np.exp(<span class="number">1j</span>*<span class="number">2</span>*np.pi*f*wTime)</span><br><span class="line">    kernel = np.flip(wavelet)</span><br><span class="line">    conv_result = np.convolve(data, kernel, <span class="string">&#x27;same&#x27;</span>)</span><br><span class="line">    wavelet_conv[i, :] = conv_result[wLength//<span class="number">2</span>:wLength//<span class="number">2</span>+<span class="built_in">len</span>(dataTime)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">plt.figure()</span><br><span class="line">plt.imshow(np.<span class="built_in">abs</span>(wavelet_conv), aspect=<span class="string">&#x27;auto&#x27;</span>, extent=[<span class="built_in">min</span>(dataTime), <span class="built_in">max</span>(dataTime), <span class="built_in">max</span>(wFreq), <span class="built_in">min</span>(wFreq)], cmap=<span class="string">&#x27;jet&#x27;</span>)</span><br><span class="line">plt.colorbar()</span><br><span class="line">plt.xlabel(<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;frequency&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="subsequent-analysis">Subsequent Analysis</h3>
<p>Using <code>real(wavelet_conv)</code> = Result projected onto the real axis = Passed through a band-pass filter.</p>
<p>Using <code>abs(wavelet_conv)</code> = Magnitude of the vector = Power of the data at the wavelet frequency.</p>
<p>Using <code>angle(wavelet_conv)</code> = Angle of the vector = Phase angle of the data relative to the wavelet at a specific time point.</p>
<p>Efficiency tip: FFT → Multiplication → IFFT can replace convolution (conv) for improved computational efficiency.</p>
<hr>
<p>Note: The content in this blog is class notes shared for educational purposes only. Some images and content are sourced from textbooks, teacher materials, and the internet. If there is any infringement, please contact <a href="mailto:aursus.blog@gmail.com">aursus.blog@gmail.com</a> for removal.</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/en/tags/Major/">Major</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/en/eeg-hilbert.html"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/en/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">BME | EEG Analysis - Hilbert Transform</div></div></a></div><div class="next-post pull-right"><a href="/en/eeg-fourier.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/en/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">BME | EEG Analysis - Fourier Transform</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/en/img/icon.png" onerror="this.onerror=null;this.src='/en/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Aursus</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">45</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Aursus" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:aursus.blog@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.linkedin.com/in/yuji-han/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#basic-concept-wavelet-transform"><span class="toc-number">1.</span> <span class="toc-text">Basic Concept: Wavelet Transform</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#convolution-kernels"><span class="toc-number">1.1.</span> <span class="toc-text">Convolution Kernels</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#types-of-wavelets"><span class="toc-number">1.1.1.</span> <span class="toc-text">Types of Wavelets</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#wavelet-families"><span class="toc-number">1.1.2.</span> <span class="toc-text">Wavelet Families</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#real-valued-morlet-wavelet"><span class="toc-number">1.2.</span> <span class="toc-text">Real-valued Morlet Wavelet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#code"><span class="toc-number">1.2.1.</span> <span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#complex-valued-morlet-wavelet"><span class="toc-number">1.3.</span> <span class="toc-text">Complex-valued Morlet Wavelet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#code"><span class="toc-number">1.3.1.</span> <span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#subsequent-analysis"><span class="toc-number">1.4.</span> <span class="toc-text">Subsequent Analysis</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Aursus</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Switch Between English And Simplified Chinese">EN</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/en/js/utils.js"></script><script src="/en/js/main.js"></script><script src="/en/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script data-pjax src="/en/self/btf.js"></script><script data-pjax src="/en/self/ch_en.js"></script></div></body></html>